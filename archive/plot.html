<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Plot visualization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .wrapper {
        display: flex;
        flex-direction: row;
        gap: 4px;
        height: 100vh;
        align-items: center;
        justify-content: center;
        padding: 4px;
      }
    </style>
  </head>
  <body class="bg-white">
    <div class="min-h-screen flex wrapper" id="inner">
      <canvas
        id="canvas"
        class="object-cover h-full w-full"
        width="1200"
        height="1200"
      ></canvas>
    </div>

    <script>
      // Initialize the global variable "input"
      window.input = window.input;
      let inputstream = [];
      let initialized = false;
      let elements = [];
      let canvas = document.getElementById('canvas');
      // Function to rerender the UI
      function rerenderUI() {
        if (!initialized && window['createElement']) {
          initialized = true;
        }
        // clear canvas
        let ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        if (window.input !== undefined && window.input.clusters) {
          if (Array.isArray(window.input.clusters)) {
            window.input.clusters.forEach((element, index) => {
              if (Array.isArray(element)) {
                element.forEach((point, i) => {
                  if (Array.isArray(point)) {
                    // create a small circle on canvas on position element[0] and element[1]
                    ctx.beginPath();
                    ctx.arc(
                      point[0] * 10 + 100,
                      point[1] * 10 + 100,
                      25,
                      0,
                      2 * Math.PI
                    );
                    ctx.fillStyle =
                      index === 0 ? 'red' : index === 1 ? 'blue' : 'green';
                    ctx.fill();
                    ctx.stroke();
                  }
                });
              }
            });
            if (window.input.centroids) {
              window.input.centroids.forEach((element, index) => {
                if (Array.isArray(element)) {
                  // create a small circle on canvas on position element[0] and element[1]
                  ctx.beginPath();
                  ctx.arc(
                    element[0] * 10 + 100,
                    element[1] * 10 + 100,
                    50,
                    0,
                    2 * Math.PI
                  );
                  ctx.fillStyle =
                    index === 0
                      ? '#800000'
                      : index === 1
                      ? '#000080'
                      : '#008000';
                  ctx.fill();
                  ctx.stroke();
                }
              });
            }
          }
        }
      }

      // Attach the rerenderUI function to the global onExecute method
      window.onExecute = rerenderUI;

      rerenderUI();
    </script>
  </body>
</html>
