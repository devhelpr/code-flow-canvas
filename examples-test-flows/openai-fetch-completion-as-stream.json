{
  "schemaType": "flow",
  "schemaVersion": "0.0.1",
  "id": "1234",
  "flows": {
    "flow": {
      "flowType": "flow",
      "nodes": [
        {
          "id": "8f4ac174-5c8e-45da-8ad4-a81a40f4f666",
          "x": 3705.3357978745244,
          "y": 1054.0469793471455,
          "width": 200,
          "height": 155,
          "nodeType": "Shape",
          "nodeInfo": {
            "type": "fetch",
            "formValues": {
              "url": "https://api.openai.com/v1/chat/completions",
              "headers": "Authorization: Bearer [openai-key]",
              "http-method": "post"
            },
            "isSettingsPopup": true
          }
        },
        {
          "id": "3cf44538-9913-4aa2-aade-a7c619910f45",
          "x": 2870.5595746525687,
          "y": 1063.2936725366305,
          "width": 161.1015625,
          "height": 136,
          "nodeType": "Shape",
          "nodeInfo": {
            "type": "json-node",
            "formValues": {
              "json": "{\n    \"messages\": [\n      { \n        \"role\": \"user\", \n        \"content\": \"Tell me a joke about visual programming in a way that bret victor approves\" \n        }\n    ],\n    \"temperature\": 0.6,\n    \"model\": \"gpt-4-turbo\",\n    \"max_tokens\": 30,\n    \"stream\": true\n}"
            },
            "nodeCannotBeReplaced": true,
            "showFormOnlyInPopup": true,
            "useInCompositionOnly": false,
            "keepPopupOpenAfterUpdate": true,
            "isRunOnStart": true
          }
        },
        {
          "id": "d186a002-218b-47dc-aae8-07522a3da6ed",
          "x": 4086.2794839807348,
          "y": 1055.5511660082343,
          "width": 119.99967430518362,
          "height": 272.0000282539267,
          "nodeType": "Shape",
          "nodeInfo": {
            "type": "show-input",
            "formValues": {
              "name": "",
              "data-type": "default"
            },
            "initializeOnStartFlow": true,
            "isSettingsPopup": true
          }
        },
        {
          "id": "383eb9cf-3b45-489e-8281-720b702b9159",
          "x": 3302.6185234344857,
          "y": 529.4952359949934,
          "width": 239.99994717902953,
          "height": 95.99996378926551,
          "nodeType": "Shape",
          "nodeInfo": {
            "type": "scope-variable",
            "formValues": {
              "variableName": "result",
              "initialValue": "",
              "fieldType": "array",
              "fieldValueType": "string",
              "enumValues": [],
              "initialEnumValue": ""
            },
            "isVariable": true,
            "nodeCannotBeReplaced": true
          }
        },
        {
          "id": "4ffd9779-4d78-4122-9619-ee6dcf7ee81d",
          "x": 5438.958340008058,
          "y": 1063.8909510153799,
          "width": 280,
          "height": 40,
          "nodeType": "Shape",
          "nodeInfo": {
            "type": "push-value-to-array-variable",
            "formValues": {
              "variableName": "result"
            },
            "nodeCannotBeReplaced": false,
            "showFormOnlyInPopup": true,
            "useInCompositionOnly": false,
            "keepPopupOpenAfterUpdate": false
          }
        },
        {
          "id": "24b43a64-3ba7-4c90-af25-de0da725600b",
          "x": 4896.59899819287,
          "y": 1062.3441942393213,
          "width": 200,
          "height": 100,
          "nodeType": "Shape",
          "nodeInfo": {
            "type": "expression",
            "formValues": {
              "expression": "choices[0].delta.content",
              "inputType": "number"
            },
            "showFormOnlyInPopup": true,
            "isSettingsPopup": true
          }
        },
        {
          "id": "bfc480ee-0c81-4221-a725-252298402221",
          "x": 4363.497084971121,
          "y": 1061.016367383506,
          "width": 110,
          "height": 110,
          "nodeType": "Shape",
          "nodeInfo": {
            "type": "map",
            "formValues": {}
          }
        },
        {
          "id": "62d6f81d-08f3-4379-8c9f-f41f3452ea52",
          "x": 4625.62260857533,
          "y": 1063.1032901616265,
          "width": 150,
          "height": 150,
          "nodeType": "Shape",
          "nodeInfo": {
            "type": "if-condition",
            "formValues": {
              "Mode": "expression",
              "expression": "choices[0].delta.role != \"assistant\" && hasContent(choices[0].delta)",
              "inputType": "boolean"
            }
          }
        },
        {
          "id": "604d00b5-69c4-4beb-8aca-394674de0d61",
          "x": 3778.1806630979127,
          "y": 1568.646609133624,
          "width": 260.03125,
          "height": 136,
          "nodeType": "Shape",
          "nodeInfo": {
            "type": "register-expression-function-node",
            "formValues": {
              "customFunctionCode": "(a) => {\n  return a.content !== undefined;\n};",
              "functionName": "hasContent"
            },
            "nodeCannotBeReplaced": true,
            "showFormOnlyInPopup": true,
            "useInCompositionOnly": false,
            "keepPopupOpenAfterUpdate": true,
            "isRunOnStart": true
          }
        },
        {
          "id": "2a227359-4016-4fa7-9788-948030bc0e90",
          "x": 3287.9477488867783,
          "y": 1054.0470154874329,
          "width": 200,
          "height": 128,
          "nodeType": "Shape",
          "nodeInfo": {
            "type": "reset-variable",
            "formValues": {
              "variableName": "result"
            },
            "nodeCannotBeReplaced": false,
            "showFormOnlyInPopup": false,
            "useInCompositionOnly": false,
            "keepPopupOpenAfterUpdate": false
          }
        },
        {
          "id": "1a35b609-3594-4529-bec1-2b50b205aa0d",
          "x": 3031.6611371525687,
          "y": 1131.2936725366305,
          "endX": 3287.9477488867783,
          "endY": 1118.0470154874329,
          "startNodeId": "3cf44538-9913-4aa2-aade-a7c619910f45",
          "endNodeId": "2a227359-4016-4fa7-9788-948030bc0e90",
          "startThumbName": "input",
          "endThumbName": "input",
          "lineType": "BezierCubic",
          "nodeType": "Connection",
          "layer": 1,
          "nodeInfo": {}
        },
        {
          "id": "a16c5c54-c867-41af-a922-9a014786c513",
          "x": 3905.3357978745244,
          "y": 1084.0469793471455,
          "endX": 4086.2794839807348,
          "endY": 1085.5511660082343,
          "startNodeId": "8f4ac174-5c8e-45da-8ad4-a81a40f4f666",
          "endNodeId": "d186a002-218b-47dc-aae8-07522a3da6ed",
          "startThumbName": "output",
          "endThumbName": "input",
          "lineType": "BezierCubic",
          "nodeType": "Connection",
          "layer": 1,
          "nodeInfo": {}
        },
        {
          "id": "9c9efadf-8473-439f-849b-1fa8cbc09ad5",
          "x": 4206.279158285918,
          "y": 1085.5511660082343,
          "endX": 4363.497084971121,
          "endY": 1116.016367383506,
          "startNodeId": "d186a002-218b-47dc-aae8-07522a3da6ed",
          "endNodeId": "bfc480ee-0c81-4221-a725-252298402221",
          "startThumbName": "output",
          "endThumbName": "input",
          "lineType": "BezierCubic",
          "nodeType": "Connection",
          "layer": 1,
          "nodeInfo": {}
        },
        {
          "id": "782908ad-a7fc-4086-b2d0-8491bb9bafa9",
          "x": 5096.59899819287,
          "y": 1112.3441942393213,
          "endX": 5438.958340008058,
          "endY": 1083.8909510153799,
          "startNodeId": "24b43a64-3ba7-4c90-af25-de0da725600b",
          "endNodeId": "4ffd9779-4d78-4122-9619-ee6dcf7ee81d",
          "startThumbName": "output",
          "endThumbName": "value",
          "lineType": "BezierCubic",
          "nodeType": "Connection",
          "layer": 1,
          "nodeInfo": {}
        },
        {
          "id": "441e2ae8-bb43-4d98-b5c2-73b5d33f1884",
          "x": 4473.497084971121,
          "y": 1141.016367383506,
          "endX": 4625.62260857533,
          "endY": 1138.1032901616265,
          "startNodeId": "bfc480ee-0c81-4221-a725-252298402221",
          "endNodeId": "62d6f81d-08f3-4379-8c9f-f41f3452ea52",
          "startThumbName": "output2",
          "endThumbName": "input",
          "lineType": "BezierCubic",
          "nodeType": "Connection",
          "layer": 1,
          "nodeInfo": {}
        },
        {
          "id": "3766e220-8955-4981-9ea5-94bd56926cc1",
          "x": 4700.62260857533,
          "y": 1063.1032901616265,
          "endX": 4896.59899819287,
          "endY": 1112.3441942393213,
          "startNodeId": "62d6f81d-08f3-4379-8c9f-f41f3452ea52",
          "endNodeId": "24b43a64-3ba7-4c90-af25-de0da725600b",
          "startThumbName": "success",
          "endThumbName": "input",
          "lineType": "BezierCubic",
          "nodeType": "Connection",
          "layer": 1,
          "nodeInfo": {}
        },
        {
          "id": "b58697e4-82bf-4d83-917a-03be6daedc12",
          "x": 3487.9477488867783,
          "y": 1118.0470154874329,
          "endX": 3705.3357978745244,
          "endY": 1131.5469793471455,
          "startNodeId": "2a227359-4016-4fa7-9788-948030bc0e90",
          "endNodeId": "8f4ac174-5c8e-45da-8ad4-a81a40f4f666",
          "startThumbName": "output",
          "endThumbName": "input",
          "lineType": "BezierCubic",
          "nodeType": "Connection",
          "layer": 1,
          "nodeInfo": {}
        }
      ]
    }
  },
  "compositions": {}
}